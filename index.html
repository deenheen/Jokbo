<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Med-Study OS Demo</title>
    <style>
        /* [ê¸°ë³¸ ì„¤ì •] */
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: sans-serif; }
        body { background-color: #e9ecef; height: 100vh; display: flex; justify-content: center; align-items: center; overflow: hidden; }

        /* [íƒœë¸”ë¦¿ í”„ë ˆì„] */
        .tablet-frame {
            width: 1400px;
            height: 900px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 30px 80px rgba(0,0,0,0.2);
            border: 10px solid #222;
            display: flex;
            overflow: hidden;
        }

        /* [ì™¼ìª½: PDF ì˜ì—­] */
        .left-panel {
            flex: 1.3;
            background-color: #525659;
            display: flex;
            flex-direction: column;
            border-right: 1px solid #ddd;
            position: relative;
        }
        
        .current-page-badge {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            z-index: 100;
            backdrop-filter: blur(4px);
        }

        .pdf-scroll-area {
            flex: 1;
            overflow-y: auto;
            padding: 30px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 40px; 
            scroll-behavior: smooth;
        }
        
        .pdf-page {
            width: 100%;
            max-width: 700px;
            height: 900px;
            background: white;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            position: relative;
            padding: 50px;
            transition: transform 0.3s;
        }
        
        .pdf-page.active-view {
            border: 4px solid #2196f3;
            transform: scale(1.02);
        }

        .page-num { position: absolute; bottom: 20px; right: 20px; color: #999; }
        .pdf-title { font-size: 24px; font-weight: bold; margin-bottom: 20px; color: #333; border-bottom: 2px solid #333; padding-bottom: 10px; }
        .pdf-text { font-size: 16px; line-height: 1.8; color: #444; text-align: justify; margin-bottom: 20px; }

        /* [ë“œë˜ê·¸ëœ ë©”ëª¨] */
        .dropped-note {
            position: absolute;
            width: 220px;
            background-color: #fff9c4;
            border-left: 5px solid #fbc02d;
            padding: 10px;
            font-size: 12px;
            color: #333;
            box-shadow: 2px 4px 10px rgba(0,0,0,0.15);
            border-radius: 0 8px 8px 0;
            cursor: pointer;
            z-index: 100;
        }
        .dropped-note:hover { transform: scale(1.05); }

        /* [ì˜¤ë¥¸ìª½: ê¸°ëŠ¥ íŒ¨ë„] */
        .right-panel {
            flex: 0.7;
            display: flex;
            flex-direction: column;
            background: #f8f9fa;
            border-left: 1px solid #ddd;
        }
        
        .tabs { display: flex; border-bottom: 1px solid #ddd; background: white; }
        .tab { flex: 1; padding: 15px; text-align: center; cursor: pointer; font-weight: bold; color: #888; }
        .tab.active { color: #2196f3; border-bottom: 3px solid #2196f3; background: #f0f7ff; }
        
        .tab-content { flex: 1; overflow-y: auto; display: none; padding: 20px; }
        .tab-content.active { display: block; }

        /* [ì±„íŒ… ìŠ¤íƒ€ì¼] */
        .chat-container { display: flex; flex-direction: column; gap: 15px; padding-bottom: 50px; }
        .msg-date { text-align: center; font-size: 12px; color: #aaa; margin: 20px 0; position: relative; }
        .msg-date::before { content:""; position: absolute; top: 50%; left: 0; width: 30%; height: 1px; background: #ddd; }
        .msg-date::after { content:""; position: absolute; top: 50%; right: 0; width: 30%; height: 1px; background: #ddd; }

        .bubble { 
            max-width: 90%; padding: 12px 16px; border-radius: 12px; font-size: 14px; line-height: 1.5; 
            transition: background 0.5s; 
        }
        .user-msg { align-self: flex-end; background: #e9ecef; color: #333; border-bottom-right-radius: 2px; }
        .ai-msg { align-self: flex-start; background: #e3f2fd; color: #0d47a1; border-bottom-left-radius: 2px; cursor: grab; }
        
        .active-context-bg {
            background-color: #fff176 !important;
            box-shadow: 0 0 15px rgba(255, 241, 118, 0.5);
            border: 2px solid #fbc02d;
        }

        /* [ì¡±ë³´ ì¹´ë“œ ìŠ¤íƒ€ì¼] */
        .jokbo-card { background: white; padding: 15px; border-radius: 8px; border: 1px solid #ddd; margin-bottom: 10px; display: none; }
        .jokbo-card.visible { display: block; animation: fadeIn 0.5s; }
        .badge { display: inline-block; padding: 3px 8px; background: #ffebee; color: #c62828; font-size: 11px; border-radius: 4px; font-weight: bold; margin-bottom: 5px;}

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<div class="tablet-frame">
    <div class="left-panel">
        <div class="current-page-badge" id="pageBadge">Page 13 / 60</div>
        
        <div class="pdf-scroll-area" id="pdfArea" onscroll="detectPage()">
            <div class="pdf-page" id="p13" ondrop="drop(event)" ondragover="allowDrop(event)">
                <div class="page-num">13</div>
                <div class="pdf-title">Chapter 4. ë‹¹ë‡¨ë³‘ì„± ì¼€í†¤ì‚°ì¦ (DKA)</div>
                <p class="pdf-text">
                    <strong>1. ì •ì˜ ë° ê°œìš”</strong><br>
                    ì¸ìŠë¦° ê²°í•ìœ¼ë¡œ ì¸í•œ ê³ í˜ˆë‹¹, ëŒ€ì‚¬ì„± ì‚°ì¦, ì¼€í†¤ì¦ì„ íŠ¹ì§•ìœ¼ë¡œ í•˜ëŠ” ê¸‰ì„± ëŒ€ì‚¬ í•©ë³‘ì¦ì´ë‹¤.<br><br>
                    <strong>2. ë³‘íƒœ ìƒë¦¬</strong><br>
                    ì¸ìŠë¦°ì´ ë¶€ì¡±í•˜ë©´ ì„¸í¬ê°€ í¬ë„ë‹¹ì„ ì“°ì§€ ëª»í•´ ì§€ë°©ì„ ë¶„í•´í•œë‹¤. ì´ë•Œ ê°„ì—ì„œ ì§€ë°©ì‚°ì´ ì‚°í™”ë˜ì–´ 'ì¼€í†¤ì²´'ê°€ ê³¼ë‹¤ ìƒì„±ëœë‹¤.
                </p>
                <div class="dropped-note" style="top: 300px; left: 400px;" onclick="focusChat('chat-13-2')">
                    ğŸ”— AI ë©”ëª¨: ì¼€í†¤ì²´ ìƒì„± ì›ë¦¬<br>(í´ë¦­ ì‹œ ì±„íŒ… ì´ë™)
                </div>
            </div>

            <div class="pdf-page" id="p14" ondrop="drop(event)" ondragover="allowDrop(event)">
                <div class="page-num">14</div>
                <div class="pdf-title">Chapter 4. DKAì˜ ì„ìƒ ì¦ìƒ</div>
                <p class="pdf-text">
                    <strong>3. ì£¼ìš” ì¦ìƒ</strong><br>
                    ì´ˆê¸°ì—ëŠ” ë‹¤ë‡¨, ë‹¤ìŒ, ì „ì‹  ìœ„ì•½ê°ì´ ë‚˜íƒ€ë‚œë‹¤.<br>
                    ì‚°ì¦ì´ ì‹¬í•´ì§€ë©´ í˜¸í¡ ë³´ìƒê¸°ì „ìœ¼ë¡œ <strong>ì¿ ìŠ¤ë§ˆìš¸ í˜¸í¡(Kussmaul Breathing)</strong>ì´ ë‚˜íƒ€ë‚˜ë©°, í˜¸ê¸° ì‹œ ê³¼ì¼ ëƒ„ìƒˆê°€ ë‚œë‹¤.
                </p>
            </div>

            <div class="pdf-page" id="p15" ondrop="drop(event)" ondragover="allowDrop(event)">
                <div class="page-num">15</div>
                <div class="pdf-title">Chapter 4. DKAì˜ ì¹˜ë£Œ ì›ì¹™</div>
                <p class="pdf-text">
                    <strong>4. ì¹˜ë£Œ (Treatment)</strong><br>
                    ì‘ê¸‰ ì¹˜ë£Œì˜ í•µì‹¬ì€ ìˆ˜ì•¡ ìš”ë²•(Hydration), ì¸ìŠë¦° íˆ¬ì—¬, ì „í•´ì§ˆ êµì •ì´ë‹¤.<br><br>
                    <span style="background:#fff59d">â€» ì£¼ì˜: í˜ˆì²­ ì¹¼ë¥¨(K+) ë†ë„ê°€ 3.3mEq/L ë¯¸ë§Œì¸ ê²½ìš°, ì¸ìŠë¦° íˆ¬ì—¬ ì „ ì¹¼ë¥¨ì„ ë¨¼ì € êµì •í•´ì•¼ í•œë‹¤.</span>
                </p>
            </div>
        </div>
    </div>

    <div class="right-panel">
        <div class="tabs">
            <div class="tab active" onclick="showTab('tab-chat')">AI ì±„íŒ… (History)</div>
            <div class="tab" onclick="showTab('tab-jokbo')">ê´€ë ¨ ì¡±ë³´</div>
        </div>

        <div id="tab-chat" class="tab-content active">
            <div class="chat-container">
                <div class="msg-date">Page 13 í•™ìŠµ ì¤‘ ì§ˆë¬¸ (3ì¼ ì „)</div>
                <div class="bubble user-msg">DKAê°€ ì •í™•íˆ ë­ì•¼?</div>
                <div class="bubble ai-msg" id="chat-13-1" draggable="true" ondragstart="drag(event)">
                    ì¸ìŠë¦° ë¶€ì¡±ìœ¼ë¡œ ì¼€í†¤ì‚°ì´ ìŒ“ì—¬ í˜ˆì•¡ì´ ì‚°ì„±í™”ë˜ëŠ” ì‘ê¸‰ ì§ˆí™˜ì…ë‹ˆë‹¤.
                </div>
                <div class="bubble user-msg">ì™œ ì‚°ì„±ì´ ë˜ëŠ” ê±°ì•¼?</div>
                <div class="bubble ai-msg" id="chat-13-2" draggable="true" ondragstart="drag(event)">
                    í¬ë„ë‹¹ ëŒ€ì‹  ì§€ë°©ì„ íƒœìš°ë©´ì„œ ë¶€ì‚°ë¬¼ë¡œ 'ì¼€í†¤ì²´(ì‚°ì„± ë¬¼ì§ˆ)'ê°€ ë‚˜ì˜¤ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.
                </div>

                <div class="msg-date">Page 14 í•™ìŠµ ì¤‘ ì§ˆë¬¸ (2ì¼ ì „)</div>
                <div class="bubble user-msg">ì¿ ìŠ¤ë§ˆìš¸ í˜¸í¡ì´ ë­ì•¼?</div>
                <div class="bubble ai-msg" id="chat-14-1" draggable="true" ondragstart="drag(event)">
                    ì‚°ì„± í˜ˆì•¡ì„ ì¤‘í™”ì‹œí‚¤ê¸° ìœ„í•´ CO2ë¥¼ ë‚´ë³´ë‚´ë ¤ê³  ê¹Šê³  ë¹ ë¥´ê²Œ ì‰¬ëŠ” í˜¸í¡ì…ë‹ˆë‹¤.
                </div>

                <div class="msg-date">Page 15 í•™ìŠµ ì¤‘ ì§ˆë¬¸ (ë°©ê¸ˆ ì „)</div>
                <div class="bubble user-msg">ì¹˜ë£Œí•  ë•Œ ì¸ìŠë¦°ë¶€í„° ì¤˜?</div>
                <div class="bubble ai-msg" id="chat-15-1" draggable="true" ondragstart="drag(event)">
                    ì•„ë‡¨! <strong>ìˆ˜ì•¡(Hydration)ì´ 1ìˆœìœ„</strong>ì…ë‹ˆë‹¤.
                </div>
            </div>
        </div>

        <div id="tab-jokbo" class="tab-content">
            <div style="color:#666; font-size:13px; margin-bottom:15px;">ê´€ë ¨ ê¸°ì¶œë¬¸ì œ</div>
            
            <div class="jokbo-card p13-item visible">
                <span class="badge">23ë…„ ê¸°ì¶œ</span>
                <div>Q. DKAì˜ ë³‘íƒœìƒë¦¬ ì¤‘ ê°„ì—ì„œì˜ ì‘ìš©ìœ¼ë¡œ ì˜³ì€ ê²ƒì€?</div>
            </div>
            <div class="jokbo-card p14-item">
                <span class="badge">22ë…„ ê¸°ì¶œ</span>
                <div>Q. ì‘ê¸‰ì‹¤ ë‚´ì› í™˜ìê°€ ê³¼ì¼ ëƒ„ìƒˆê°€ ë‚˜ê³  ê¹Šì€ í˜¸í¡ì„ í•œë‹¤. ì§„ë‹¨ì€?</div>
            </div>
            <div class="jokbo-card p15-item">
                <span class="badge">24ë…„ ì¤‘ê°„</span>
                <div>Q. K+ 2.8ì¸ DKA í™˜ìì—ê²Œ ê°€ì¥ ë¨¼ì € ì‹œí–‰í•´ì•¼ í•  ì²˜ì¹˜ëŠ”?</div>
            </div>
        </div>
    </div>
</div>

<script>
    // [ê¸°ëŠ¥: í˜ì´ì§€ ê°ì§€]
    function detectPage() {
        const scrollArea = document.getElementById('pdfArea');
        const pages = ['p13', 'p14', 'p15'];
        const viewCenter = scrollArea.scrollTop + (scrollArea.clientHeight / 2);

        pages.forEach(pageId => {
            const pageEl = document.getElementById(pageId);
            const pageTop = pageEl.offsetTop;
            const pageBottom = pageTop + pageEl.clientHeight;

            if (viewCenter >= pageTop && viewCenter <= pageBottom) {
                const pageNum = pageId.replace('p', '');
                document.getElementById('pageBadge').innerText = `Page ${pageNum} / 60`;
                
                document.querySelectorAll('.pdf-page').forEach(p => p.classList.remove('active-view'));
                pageEl.classList.add('active-view');
                syncRightPanel(pageNum);
            }
        });
    }

    // [ê¸°ëŠ¥: ì˜¤ë¥¸ìª½ íŒ¨ë„ ë™ê¸°í™”]
    function syncRightPanel(pageNum) {
        // ì¡±ë³´ í•„í„°ë§
        document.querySelectorAll('.jokbo-card').forEach(card => card.classList.remove('visible'));
        document.querySelectorAll(`.p${pageNum}-item`).forEach(card => card.classList.add('visible'));

        // ì±„íŒ… ìŠ¤í¬ë¡¤ ì´ë™
        const chatMap = { '13': 'chat-13-1', '14': 'chat-14-1', '15': 'chat-15-1' };
        const targetChatId = chatMap[pageNum];
        if (targetChatId) {
            const chatEl = document.getElementById(targetChatId);
            chatEl.scrollIntoView({ behavior: 'smooth', block: 'center' });
            highlightEffect(chatEl);
        }
    }

    function highlightEffect(element) {
        document.querySelectorAll('.active-context-bg').forEach(el => el.classList.remove('active-context-bg'));
        element.classList.add('active-context-bg');
        setTimeout(() => { element.classList.remove('active-context-bg'); }, 2000);
    }

    // [ê¸°ëŠ¥: ë“œë˜ê·¸ ì•¤ ë“œë¡­]
    function drag(ev) {
        ev.dataTransfer.setData("chatId", ev.target.id);
        ev.dataTransfer.setData("text", ev.target.innerText);
    }
    function allowDrop(ev) { ev.preventDefault(); }
    function drop(ev) {
        ev.preventDefault();
        const chatId = ev.dataTransfer.getData("chatId");
        const text = ev.dataTransfer.getData("text");
        const rect = ev.currentTarget.getBoundingClientRect();
        
        const note = document.createElement("div");
        note.className = "dropped-note";
        note.innerHTML = `ğŸ“Œ <b>AI ë©”ëª¨</b><br>${text.substring(0, 20)}...`;
        note.style.left = (ev.clientX - rect.left) + "px";
        note.style.top = (ev.clientY - rect.top) + "px";
        note.onclick = () => focusChat(chatId);
        
        ev.currentTarget.appendChild(note);
    }

    function focusChat(elementId) {
        showTab('tab-chat');
        const el = document.getElementById(elementId);
        if(el) {
            el.scrollIntoView({ behavior: 'smooth', block: 'center' });
            highlightEffect(el);
        }
    }

    function showTab(tabId) {
        document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
        document.querySelectorAll('.tab').forEach(el => el.classList.remove('active'));
        document.getElementById(tabId).classList.add('active');
        
        if(tabId === 'tab-chat') document.querySelectorAll('.tab')[0].classList.add('active');
        else document.querySelectorAll('.tab')[1].classList.add('active');
    }

    detectPage(); 
</script>

</body>
</html>
