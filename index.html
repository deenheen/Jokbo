<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Med-Study OS v8.0 (Real Medical Content)</title>
    <style>
        /* [ê¸°ë³¸ ìŠ¤íƒ€ì¼ & í°íŠ¸] */
        @import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css');
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Pretendard', sans-serif; }
        body { background-color: #f0f2f5; height: 100vh; display: flex; justify-content: center; align-items: center; overflow: hidden; }

        /* [ë©”ì¸ í”„ë ˆì„] */
        .tablet-frame {
            width: 1600px; height: 950px; background: white; border-radius: 12px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.15); border: 1px solid #ddd; display: flex; overflow: hidden;
        }

        /* --- [ì™¼ìª½: PDF ë·°ì–´ (Full Density)] --- */
        .left-panel {
            flex: 1.6; background-color: #3e3e3e; display: flex; flex-direction: column;
            border-right: 1px solid #333; position: relative;
        }
        
        .pdf-header {
            height: 48px; background: #2b2b2b; color: #e0e0e0; display: flex; align-items: center;
            padding: 0 20px; justify-content: space-between; font-size: 13px; font-weight: 500; border-bottom: 1px solid #1a1a1a;
        }

        .pdf-viewer-container {
            flex: 1; position: relative; overflow: hidden; background: #525659;
            display: flex; justify-content: center; align-items: center; padding: 20px;
        }

        /* ì‹¤ì œ PPT ìŠ¬ë¼ì´ë“œ ëŠë‚Œ */
        .pdf-page {
            width: 100%; height: 100%; max-width: 800px; max-height: 1130px; /* A4 ë¹„ìœ¨ */
            background: white; box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            padding: 40px 50px; position: absolute; display: none; flex-direction: column;
            overflow-y: auto; border-radius: 2px;
        }
        .pdf-page.active { display: flex; animation: fadeIn 0.2s ease-out; }

        @keyframes fadeIn { from { opacity: 0; transform: scale(0.98); } to { opacity: 1; transform: scale(1); } }

        /* PDF ë‚´ë¶€ ë””ìì¸ (ì „ê³µì„œì  ìŠ¤íƒ€ì¼) */
        .slide-header { border-bottom: 2px solid #003c8f; padding-bottom: 10px; margin-bottom: 25px; display: flex; justify-content: space-between; align-items: flex-end; }
        .slide-title { font-size: 24px; font-weight: 800; color: #003c8f; }
        .slide-sub { font-size: 14px; color: #666; font-weight: 600; }
        
        .content-block { margin-bottom: 25px; }
        .section-title { font-size: 16px; font-weight: 700; color: #333; margin-bottom: 8px; display: flex; align-items: center; }
        .section-title::before { content: ""; display: inline-block; width: 4px; height: 16px; background: #1565c0; margin-right: 8px; }
        
        .text-body { font-size: 14px; line-height: 1.7; color: #444; text-align: justify; letter-spacing: -0.3px; }
        .text-body strong { color: #000; font-weight: 700; }
        .text-body ul { padding-left: 20px; margin-top: 5px; }
        .text-body li { margin-bottom: 4px; }

        /* ë„í‘œ ë° ë°•ìŠ¤ ìŠ¤íƒ€ì¼ */
        .info-box { background: #f5f9ff; border: 1px solid #b3e5fc; padding: 12px; border-radius: 6px; font-size: 13px; margin: 10px 0; color: #0277bd; }
        .warn-box { background: #fff5f5; border: 1px solid #ffcdd2; padding: 12px; border-radius: 6px; font-size: 13px; margin: 10px 0; color: #c62828; font-weight: 600; }
        .lab-table { width: 100%; border-collapse: collapse; font-size: 12px; margin: 10px 0; }
        .lab-table th { background: #eee; padding: 6px; border: 1px solid #ccc; text-align: center; }
        .lab-table td { padding: 6px; border: 1px solid #ccc; text-align: center; }

        /* ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ */
        .nav-btn {
            position: absolute; top: 50%; transform: translateY(-50%);
            width: 44px; height: 44px; background: rgba(0,0,0,0.6); color: white;
            border-radius: 50%; display: flex; justify-content: center; align-items: center;
            cursor: pointer; font-size: 20px; z-index: 100; transition: 0.2s;
        }
        .nav-btn:hover { background: rgba(0,0,0,0.8); }
        .nav-prev { left: 20px; } .nav-next { right: 20px; }
        .nav-btn.disabled { opacity: 0; pointer-events: none; }

        /* ë“œë˜ê·¸ëœ ë©”ëª¨ (í¬ìŠ¤íŠ¸ì‡) */
        .dropped-note {
            position: absolute; width: 220px; background-color: #fff9c4; border-left: 4px solid #fbc02d;
            padding: 10px; font-size: 12px; color: #333; box-shadow: 2px 4px 10px rgba(0,0,0,0.2);
            border-radius: 0 6px 6px 0; cursor: pointer; z-index: 50; line-height: 1.4;
            font-family: 'Nanum Pen Script', sans-serif; /* ì†ê¸€ì”¨ ëŠë‚Œ */
        }
        .dropped-note:hover { transform: scale(1.05); z-index: 60; }
        .dropped-note strong { color: #e65100; }

        /* --- [ì˜¤ë¥¸ìª½: ê¸°ëŠ¥ íŒ¨ë„] --- */
        .right-panel {
            flex: 0.8; display: flex; flex-direction: column; background: #f7f8fa; border-left: 1px solid #ddd; position: relative;
        }
        
        /* íƒ­ ë©”ë‰´ */
        .tabs { display: flex; background: white; border-bottom: 1px solid #ddd; flex-shrink: 0; height: 50px; }
        .tab { flex: 1; display: flex; align-items: center; justify-content: center; cursor: pointer; font-weight: 600; color: #888; font-size: 14px; transition: 0.2s; }
        .tab:hover { background: #f9f9f9; }
        .tab.active { color: #2196f3; border-bottom: 3px solid #2196f3; background: #fff; }

        .tab-content-container { flex: 1; overflow-y: auto; position: relative; scroll-behavior: smooth; }
        .tab-content { display: none; padding: 20px; padding-bottom: 100px; }
        .tab-content.active { display: block; }

        /* 1. AI ì±„íŒ… (Real Chat) */
        .chat-container { display: flex; flex-direction: column; gap: 16px; }
        .msg-group { display: flex; flex-direction: column; gap: 6px; }
        .msg-meta { font-size: 11px; color: #999; margin-left: 4px; display: flex; gap: 6px; }
        
        .bubble { max-width: 92%; padding: 12px 16px; border-radius: 12px; font-size: 13.5px; line-height: 1.55; box-shadow: 0 1px 2px rgba(0,0,0,0.05); }
        .user-msg { align-self: flex-end; background: #4a90e2; color: white; border-bottom-right-radius: 2px; }
        .ai-msg { align-self: flex-start; background: white; color: #333; border: 1px solid #eee; border-bottom-left-radius: 2px; cursor: grab; }
        .ai-msg:hover { border-color: #2196f3; box-shadow: 0 2px 8px rgba(33, 150, 243, 0.15); }
        .ai-msg ul { padding-left: 18px; margin-top: 5px; }

        /* 2. ì¡±ë³´ (KMLE Style) */
        .jokbo-card { background: white; padding: 20px; border-radius: 8px; border: 1px solid #e0e0e0; margin-bottom: 15px; display: none; box-shadow: 0 2px 5px rgba(0,0,0,0.02); }
        .jokbo-card.visible { display: block; animation: fadeIn 0.3s; }
        .badge-row { margin-bottom: 10px; }
        .badge { display: inline-block; padding: 3px 8px; font-size: 11px; border-radius: 4px; font-weight: 700; margin-right: 6px; }
        .badge.year { background: #e3f2fd; color: #1565c0; }
        .badge.tag { background: #f3e5f5; color: #7b1fa2; }
        .badge.freq { background: #ffebee; color: #c62828; }
        
        .q-body { font-size: 14px; font-weight: 600; color: #222; margin-bottom: 12px; line-height: 1.5; }
        .q-lab { font-size: 12px; color: #555; background: #f9f9f9; padding: 10px; border-radius: 6px; margin-bottom: 10px; font-family: monospace; border: 1px solid #eee; }
        .q-options { font-size: 13px; color: #444; display: flex; flex-direction: column; gap: 4px; }
        .q-options div { cursor: pointer; padding: 4px 8px; border-radius: 4px; }
        .q-options div:hover { background: #f0f0f0; }

        /* 3. ìŠ¤í¬ë¦½íŠ¸ (Transcript) */
        .script-segment { background: white; padding: 16px; border-radius: 8px; border: 1px solid #eee; margin-bottom: 12px; transition: all 0.3s; }
        .script-segment:hover { border-color: #b3e5fc; background: #fbfdff; }
        .script-header { display: flex; justify-content: space-between; margin-bottom: 6px; font-size: 11px; color: #888; }
        .speaker-name { font-weight: 700; color: #1976d2; }
        .script-text { font-size: 14px; line-height: 1.6; color: #333; }
        .highlight-text { background: linear-gradient(to top, #fff59d 50%, transparent 50%); }

        /* ì˜¤ë””ì˜¤ í”Œë ˆì´ì–´ */
        .audio-player-bar {
            position: absolute; bottom: 0; left: 0; right: 0; height: 80px; background: white; border-top: 1px solid #ddd;
            display: flex; align-items: center; padding: 0 25px; gap: 20px; box-shadow: 0 -4px 20px rgba(0,0,0,0.05);
            display: none; z-index: 200;
        }
        .audio-player-bar.visible { display: flex; }
        .play-btn { width: 48px; height: 48px; background: #2196f3; border-radius: 50%; display: flex; justify-content: center; align-items: center; color: white; font-size: 20px; cursor: pointer; box-shadow: 0 4px 10px rgba(33, 150, 243, 0.4); transition: 0.2s; }
        .play-btn:hover { transform: scale(1.05); }
        .timeline-box { flex: 1; display: flex; flex-direction: column; gap: 8px; }
        .timeline-bg { height: 6px; background: #eee; border-radius: 3px; position: relative; overflow: hidden; cursor: pointer; }
        .timeline-fill { position: absolute; left: 0; top: 0; height: 100%; width: 0%; background: #2196f3; transition: width 0.2s linear; }
        .time-labels { display: flex; justify-content: space-between; font-size: 12px; color: #888; font-family: monospace; }
        
        /* ì‹±í¬ í•˜ì´ë¼ì´íŠ¸ íš¨ê³¼ */
        .active-context-bg { background-color: #fff9c4 !important; border-color: #fbc02d !important; box-shadow: 0 0 0 2px rgba(251, 192, 45, 0.3); }

    </style>
</head>
<body>

<div class="tablet-frame">
    <div class="left-panel">
        <div class="pdf-header">
            <span>ğŸ“š [Internal Med] Endocrinology_Ch04_Diabetes_Complications.pdf</span>
            <span id="headerPageNum">Page 13 / 60</span>
        </div>
        
        <div class="pdf-viewer-container">
            <div class="nav-btn nav-prev disabled" onclick="changePage(-1)">â®</div>
            <div class="nav-btn nav-next" onclick="changePage(1)">â¯</div>

            <div class="pdf-page active" id="p13" ondrop="drop(event)" ondragover="allowDrop(event)">
                <div class="slide-header">
                    <div class="slide-title">Diabetic Ketoacidosis (DKA)</div>
                    <div class="slide-sub">Endocrinology Part.4</div>
                </div>
                
                <div class="content-block">
                    <div class="section-title">1. Definition & Epidemiology</div>
                    <p class="text-body">
                        ì¸ìŠë¦°ì˜ ì ˆëŒ€ì  ê²°í•(Absolute deficiency)ê³¼ ëŒ€í•­ í˜¸ë¥´ëª¬(Counter-regulatory hormones: Glucagon, Catecholamines, Cortisol, GH)ì˜ ì¦ê°€ë¡œ ì¸í•´ ë°œìƒí•˜ëŠ” ê¸‰ì„± ëŒ€ì‚¬ í•©ë³‘ì¦ì´ë‹¤.
                        <br>ì£¼ë¡œ ì œ1í˜• ë‹¹ë‡¨ë³‘(T1DM)ì—ì„œ ë°œìƒí•˜ë‚˜, ê·¹ì‹¬í•œ ìŠ¤íŠ¸ë ˆìŠ¤ ìƒí™©(ê°ì—¼, ì™¸ìƒ)ì—ì„œëŠ” ì œ2í˜• ë‹¹ë‡¨ë³‘(T2DM)ì—ì„œë„ ë°œìƒ ê°€ëŠ¥í•˜ë‹¤.
                    </p>
                </div>

                <div class="content-block">
                    <div class="section-title">2. Pathophysiology (ë³‘íƒœìƒë¦¬)</div>
                    <p class="text-body">
                        <strong>(1) Hyperglycemia (ê³ í˜ˆë‹¹):</strong> ê°„ì—ì„œì˜ í¬ë„ë‹¹ ìƒì„± ì¦ê°€(Gluconeogenesis) ë° ë§ì´ˆ ì¡°ì§ ì´ìš© ê°ì†Œ.<br>
                        <strong>(2) Ketosis (ì¼€í†¤ì¦):</strong> ì¸ìŠë¦° ë¶€ì¡± â†’ Lipolysis ì¦ê°€ â†’ Free Fatty Acid(FFA) ë°©ì¶œ â†’ ê°„ì—ì„œ Beta-oxidation â†’ Ketone bodies ìƒì„±.<br>
                    </p>
                    <div class="info-box">
                        <strong>ğŸ’¡ Key Mechanism:</strong><br>
                        Acetoacetate & Beta-hydroxybutyrate (Organic acids) accumulation <br>
                        â†’ High Anion Gap Metabolic Acidosis (HAGMA)
                    </div>
                </div>
                <div class="dropped-note" style="top:450px; left:450px;" onclick="focusChat('chat-13-1')">ğŸ“Œ AI ë©”ëª¨: ë³‘íƒœìƒë¦¬ í•µì‹¬ ìš”ì•½</div>
            </div>

            <div class="pdf-page" id="p14" ondrop="drop(event)" ondragover="allowDrop(event)">
                <div class="slide-header">
                    <div class="slide-title">Precipitating Factors</div>
                    <div class="slide-sub">What triggers DKA?</div>
                </div>
                
                <div class="content-block">
                    <div class="section-title">Common Triggers (ìœ ë°œ ì¸ì)</div>
                    <p class="text-body">
                        <ul>
                            <li><strong>Infection (m/c, 30-40%):</strong> Pneumonia, UTI, Sepsis.</li>
                            <li><strong>Insulin Omission:</strong> í™˜ìì˜ ì„ì˜ íˆ¬ì—¬ ì¤‘ë‹¨, íŒí”„ ê³ ì¥.</li>
                            <li><strong>New Onset DM:</strong> ë‹¹ë‡¨ì¸ ì¤„ ëª°ëë˜ í™˜ìì˜ ì²« ì¦ìƒ (20-25%).</li>
                            <li>Acute Illness: MI, CVA, Pancreatitis, Trauma.</li>
                            <li>Drugs: Steroids, Thiazides, SGLT2 inhibitors (Euglycemic DKA).</li>
                        </ul>
                    </p>
                </div>
                <div class="warn-box">
                    <strong>âš ï¸ Clinical Pearl:</strong><br>
                    ê°ì—¼ ì§•í›„(ë°œì—´)ê°€ ì—†ë”ë¼ë„ ë°±í˜ˆêµ¬ ì¦ê°€(Leukocytosis)ëŠ” DKA ìì²´ë¡œ ë‚˜íƒ€ë‚  ìˆ˜ ìˆë‹¤. (Stress response)
                </div>
            </div>

            <div class="pdf-page" id="p15" ondrop="drop(event)" ondragover="allowDrop(event)">
                <div class="slide-header">
                    <div class="slide-title">Clinical Features</div>
                    <div class="slide-sub">Symptoms & Signs</div>
                </div>

                <div class="content-block">
                    <div class="section-title">Symptoms</div>
                    <p class="text-body">
                        - Polyuria, Polydipsia, Weight loss (ìˆ˜ì¼ê°„ ì§€ì†)<br>
                        - Weakness, Mental change (Alert ~ Coma)<br>
                        - <strong>GI Symptoms:</strong> Nausea, Vomiting, Diffuse Abdominal Pain (50% ì´ìƒì—ì„œ ë°œìƒ, ê¸‰ì„± ë³µì¦ê³¼ ê°ë³„ ìš”í•¨)
                    </p>
                </div>
                <div class="content-block">
                    <div class="section-title">Physical Findings</div>
                    <p class="text-body">
                        - Dehydration: Tachycardia, Hypotension, Dry skin, Poor skin turgor.<br>
                        - <strong>Kussmaul Respiration:</strong> Rapid & Deep breathing (Compensatory mechanism for metabolic acidosis).<br>
                        - Acetone breath odor (Fruity smell).
                    </p>
                </div>
            </div>

            <div class="pdf-page" id="p16" ondrop="drop(event)" ondragover="allowDrop(event)">
                <div class="slide-header">
                    <div class="slide-title">Diagnosis & Lab Findings</div>
                    <div class="slide-sub">Diagnostic Criteria</div>
                </div>

                <table class="lab-table">
                    <tr><th>Test</th><th>DKA Criteria</th><th>Significance</th></tr>
                    <tr><td>Plasma Glucose</td><td>> 250 mg/dL</td><td>Hyperglycemia</td></tr>
                    <tr><td>Arterial pH</td><td>< 7.30</td><td>Acidosis</td></tr>
                    <tr><td>Serum Bicarb</td><td>< 18 mEq/L</td><td>Consumpted</td></tr>
                    <tr><td>Urine/Serum Ketone</td><td>Positive</td><td>Lipolysis marker</td></tr>
                    <tr><td>Anion Gap</td><td>> 10~12</td><td>HAGMA</td></tr>
                </table>

                <div class="info-box">
                    <strong>Formula:</strong> Anion Gap = $Na^+ - (Cl^- + HCO_3^-)$<br>
                    (ì •ìƒì¹˜: 12 Â± 2 mEq/L)
                </div>
                <div class="dropped-note" style="top:500px; left:400px;" onclick="focusChat('chat-16-1')">ğŸ“Œ AI ë©”ëª¨: AG ê³„ì‚°ë²•</div>
            </div>

            <div class="pdf-page" id="p17" ondrop="drop(event)" ondragover="allowDrop(event)">
                <div class="slide-header">
                    <div class="slide-title">Management: Fluid Therapy</div>
                    <div class="slide-sub">Step 1. Hydration</div>
                </div>

                <div class="content-block">
                    <div class="section-title">Fluid Resuscitation Protocol</div>
                    <p class="text-body">
                        DKA í™˜ìëŠ” í‰ê·  6L (ì²´ì¤‘ì˜ 10%) ê°€ëŸ‰ì˜ ìˆ˜ë¶„ ê²°í• ìƒíƒœì´ë‹¤.<br>
                        <strong>1. Initial:</strong> 0.9% Normal Saline (NS) 1,000mL in first hour.<br>
                        <strong>2. Subsequent:</strong> Corrected $Na^+$ í™•ì¸ í›„ ê²°ì •.<br>
                        &nbsp;&nbsp; - High/Normal Na â†’ 0.45% NaCl<br>
                        &nbsp;&nbsp; - Low Na â†’ 0.9% NaCl<br>
                        <strong>3. Maintenance:</strong> í˜ˆë‹¹ < 200mg/dL ë„ë‹¬ ì‹œ 5% Dextrose (D5W) ì¶”ê°€ (ì €í˜ˆë‹¹ ì˜ˆë°©).
                    </p>
                </div>
            </div>

            <div class="pdf-page" id="p18" ondrop="drop(event)" ondragover="allowDrop(event)">
                <div class="slide-header">
                    <div class="slide-title">Management: Potassium ($K^+$)</div>
                    <div class="slide-sub">Step 2. Electrolyte Correction</div>
                </div>

                <div class="warn-box">
                    <strong>ğŸš¨ CRITICAL STEP: Check $K^+$ before Insulin!</strong><br>
                    ì¸ìŠë¦°ì€ $K^+$ë¥¼ ì„¸í¬ ë‚´ë¡œ ì´ë™ì‹œì¼œ ì‹¬ê°í•œ Hypokalemia ë° ë¶€ì •ë§¥(Arrhythmia)ì„ ìœ ë°œí•  ìˆ˜ ìˆë‹¤.
                </div>

                <div class="content-block">
                    <div class="section-title">Potassium Replacement Guide</div>
                    <p class="text-body">
                        1) <strong>$K^+$ < 3.3 mEq/L:</strong> <span style="color:red; font-weight:bold;">HOLD Insulin!</span> Give KCl 20-30 mEq/hr until $K^+$ > 3.3.<br>
                        2) <strong>$K^+$ 3.3 ~ 5.2 mEq/L:</strong> Give KCl 20-30 mEq per liter of IV fluid (to prevent drop).<br>
                        3) <strong>$K^+$ > 5.2 mEq/L:</strong> Do not give K, but check every 2 hrs.
                    </p>
                </div>
                <div class="dropped-note" style="top:350px; left:50%;" onclick="focusChat('chat-18-1')">ğŸ“Œ AI ë©”ëª¨: ì¸ìŠë¦° íˆ¬ì—¬ ê¸ˆê¸°ì‚¬í•­</div>
            </div>

            <div class="pdf-page" id="p19" ondrop="drop(event)" ondragover="allowDrop(event)">
                <div class="slide-header">
                    <div class="slide-title">Management: Insulin Therapy</div>
                    <div class="slide-sub">Step 3. Reverse Ketosis</div>
                </div>

                <div class="content-block">
                    <div class="section-title">IV Regular Insulin (RI)</div>
                    <p class="text-body">
                        - <strong>Loading:</strong> 0.1 unit/kg IV bolus.<br>
                        - <strong>Maintenance:</strong> 0.1 unit/kg/hr IV continuous infusion.<br>
                        - <strong>Goal:</strong> í˜ˆë‹¹ì´ ì‹œê°„ë‹¹ 50~70 mg/dL ì”© ê°ì†Œí•˜ë„ë¡ ì¡°ì ˆ.
                    </p>
                </div>
                <div class="info-box">
                    <strong>Transition to SC Insulin:</strong><br>
                    DKAê°€ í•´ê²°(Gap ë‹«í˜, í™˜ì ì‹ì‚¬ ê°€ëŠ¥)ë˜ë©´ í”¼í•˜ ì£¼ì‚¬(SC)ë¡œ ì „í™˜í•œë‹¤. ë°˜ê°ê¸°ë¥¼ ê³ ë ¤í•´ IV ì¤‘ë‹¨ 1-2ì‹œê°„ ì „ì— SCë¥¼ ë¨¼ì € íˆ¬ì—¬í•œë‹¤ (Overlap).
                </div>
            </div>

            <div class="pdf-page" id="p20" ondrop="drop(event)" ondragover="allowDrop(event)">
                <div class="slide-header">
                    <div class="slide-title">Complications of Therapy</div>
                    <div class="slide-sub">What to watch out for</div>
                </div>
                <div class="content-block">
                    <div class="section-title">1. Hypoglycemia & Hypokalemia</div>
                    <p class="text-body">ê³¼ë„í•œ ì¸ìŠë¦° ì‚¬ìš©ìœ¼ë¡œ ì¸í•œ ê°€ì¥ í”í•œ í•©ë³‘ì¦.</p>
                </div>
                <div class="content-block">
                    <div class="section-title">2. Cerebral Edema (ë‡Œë¶€ì¢…)</div>
                    <p class="text-body">
                        - ì£¼ë¡œ ì†Œì•„/ì²­ì†Œë…„ì—ì„œ ë°œìƒ (ì‚¬ë§ë¥  ë†’ìŒ).<br>
                        - ì›ì¸: ê¸‰ê²©í•œ ì‚¼íˆ¬ì•• ì €í•˜, ê³¼ë„í•œ ìˆ˜ì•¡ ê³µê¸‰.<br>
                        - ì¦ìƒ: ë‘í†µ, ì˜ì‹ ì €í•˜, ì„œë§¥, êµ¬í† .<br>
                        - ì¹˜ë£Œ: <strong>Mannitol</strong> IV, ìˆ˜ì•¡ ì†ë„ ê°ëŸ‰.
                    </p>
                </div>
            </div>

            <div class="pdf-page" id="p21" ondrop="drop(event)" ondragover="allowDrop(event)">
                <div class="slide-header">
                    <div class="slide-title">HHS (Hyperosmolar Hyperglycemic State)</div>
                    <div class="slide-sub">Comparison with DKA</div>
                </div>
                <table class="lab-table">
                    <tr><th>Feature</th><th>DKA</th><th>HHS</th></tr>
                    <tr><td>Patient</td><td>Young (T1DM)</td><td>Elderly (T2DM)</td></tr>
                    <tr><td>Glucose</td><td>> 250</td><td>> 600 (Very High)</td></tr>
                    <tr><td>pH / Bicarb</td><td>< 7.3 / Low</td><td>> 7.3 / Normal</td></tr>
                    <tr><td>Ketones</td><td>Positive</td><td>Small / Negative</td></tr>
                    <tr><td>Osmolality</td><td>Variable</td><td>> 320 mOsm/kg</td></tr>
                    <tr><td>Mental</td><td>Alert ~ Drowsy</td><td>Stupor ~ Coma</td></tr>
                </table>
            </div>

            <div class="pdf-page" id="p22" ondrop="drop(event)" ondragover="allowDrop(event)">
                <div class="slide-header">
                    <div class="slide-title">Sick Day Management</div>
                    <div class="slide-sub">Patient Education</div>
                </div>
                <div class="content-block">
                    <p class="text-body">
                        ë‹¹ë‡¨ í™˜ìê°€ ë‹¤ë¥¸ ì§ˆë³‘(ê°ê¸°, ì¥ì—¼ ë“±)ì„ ì•“ì„ ë•Œ í˜ˆë‹¹ ê´€ë¦¬ ì›ì¹™.<br>
                        1. <strong>Never Stop Insulin:</strong> ì‹ì‚¬ë¥¼ ëª» í•´ë„ ì¸ìŠë¦°ì„ ì¤‘ë‹¨í•˜ë©´ ì•ˆ ë¨ (Stress hormoneìœ¼ë¡œ í˜ˆë‹¹ ìƒìŠ¹).<br>
                        2. <strong>Frequent Monitoring:</strong> 4ì‹œê°„ë§ˆë‹¤ í˜ˆë‹¹/ì¼€í†¤ ì¸¡ì •.<br>
                        3. <strong>Hydration:</strong> íƒˆìˆ˜ ì˜ˆë°©ì„ ìœ„í•´ ìˆ˜ë¶„ ì„­ì·¨ ê¶Œì¥.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <div class="right-panel">
        <div class="tabs">
            <div class="tab active" onclick="showTab('tab-chat')">AI ì±„íŒ…</div>
            <div class="tab" onclick="showTab('tab-jokbo')">ê´€ë ¨ ì¡±ë³´</div>
            <div class="tab" onclick="showTab('tab-script')">ë…¹ìŒ ìŠ¤í¬ë¦½íŠ¸</div>
        </div>

        <div class="tab-content-container">
            <div id="tab-chat" class="tab-content active">
                <div class="chat-container">
                    <div class="msg-group" id="chat-13-1">
                        <div class="msg-meta"><span>Page 13</span><span>â€¢</span><span>ë³‘íƒœìƒë¦¬</span></div>
                        <div class="bubble user-msg">DKAì˜ í•µì‹¬ ê¸°ì „ì´ ë­ì•¼?</div>
                        <div class="bubble ai-msg" draggable="true" ondragstart="drag(event)">
                            <strong>3ëŒ€ ìš”ì†Œ</strong>ê°€ í•µì‹¬ì…ë‹ˆë‹¤.<br>
                            1. ì¸ìŠë¦° ê²°í• (Insulin deficiency)<br>
                            2. ëŒ€í•­ í˜¸ë¥´ëª¬ ì¦ê°€ (Counter-regulatory hormones â†‘)<br>
                            ì´ë¡œ ì¸í•´ <strong>ì§€ë°© ë¶„í•´(Lipolysis)</strong>ê°€ ê°€ì†í™”ë˜ê³ , ê°„ì—ì„œ ì¼€í†¤ì²´ê°€ ìƒì„±ë˜ì–´ <strong>ëŒ€ì‚¬ì„± ì‚°ì¦</strong>ì´ ë°œìƒí•©ë‹ˆë‹¤.
                        </div>
                    </div>
                    
                    <div class="msg-group" id="chat-14-1">
                        <div class="msg-meta"><span>Page 14</span><span>â€¢</span><span>ì„ìƒì¦ìƒ</span></div>
                        <div class="bubble user-msg">ê°ì—¼ ì§•í›„ê°€ ì—†ëŠ”ë° ë°±í˜ˆêµ¬ê°€ ë†’ì„ ìˆ˜ ìˆì–´?</div>
                        <div class="bubble ai-msg" draggable="true" ondragstart="drag(event)">
                            ë„¤, ê°€ëŠ¥í•©ë‹ˆë‹¤. DKA ìì²´ê°€ ê·¹ì‹¬í•œ ìŠ¤íŠ¸ë ˆìŠ¤ ìƒí™©ì´ë¯€ë¡œ ì½”í‹°ì†”ê³¼ ì¹´í…Œì½œì•„ë¯¼ì´ ë¶„ë¹„ë˜ì–´ <strong>ë°˜ì‘ì„± ë°±í˜ˆêµ¬ ì¦ê°€(Leukocytosis)</strong>ê°€ ë‚˜íƒ€ë‚©ë‹ˆë‹¤. 25,000/uL ì´ìƒì´ ì•„ë‹ˆë¼ë©´ ê°ì—¼ ì—†ì´ë„ ë³´ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                        </div>
                    </div>

                    <div class="msg-group" id="chat-15-1">
                        <div class="msg-meta"><span>Page 15</span><span>â€¢</span><span>ì§„ì°°ì†Œê²¬</span></div>
                        <div class="bubble user-msg">ì¿ ìŠ¤ë§ˆìš¸ í˜¸í¡ì´ ì •í™•íˆ ì–´ë–¤ ê±°ì•¼?</div>
                        <div class="bubble ai-msg" draggable="true" ondragstart="drag(event)">
                            í˜ˆì•¡ì´ ì‚°ì„±ì´ ë˜ë©´(pH ì €í•˜), ìš°ë¦¬ ëª¸ì€ ì´ì‚°í™”íƒ„ì†Œ($CO_2$)ë¥¼ ë°°ì¶œí•˜ì—¬ pHë¥¼ ì˜¬ë¦¬ë ¤ê³  í•©ë‹ˆë‹¤. ì´ë•Œ ë‚˜íƒ€ë‚˜ëŠ” <strong>ê¹Šê³  ë¹ ë¥¸ í˜¸í¡(Deep & Rapid breathing)</strong>ì„ ë§í•˜ë©°, í˜¸ê¸° ì‹œ ì•„ì„¸í†¤(ê³¼ì¼) ëƒ„ìƒˆê°€ íŠ¹ì§•ì ì…ë‹ˆë‹¤.
                        </div>
                    </div>

                    <div class="msg-group" id="chat-16-1">
                        <div class="msg-meta"><span>Page 16</span><span>â€¢</span><span>Lab</span></div>
                        <div class="bubble user-msg">Anion Gap ê³„ì‚° ê³µì‹ ì•Œë ¤ì¤˜.</div>
                        <div class="bubble ai-msg" draggable="true" ondragstart="drag(event)">
                            $AG = Na^+ - (Cl^- + HCO_3^-)$ ì…ë‹ˆë‹¤.<br>
                            ì •ìƒì¹˜ëŠ” 12Â±2 ì´ë©°, DKAì—ì„œëŠ” ì¼€í†¤ì‚°(ì¸¡ì •ë˜ì§€ ì•ŠëŠ” ìŒì´ì˜¨)ì´ ì¦ê°€í•˜ë¯€ë¡œ <strong>High AG Metabolic Acidosis</strong> ì†Œê²¬ì„ ë³´ì…ë‹ˆë‹¤.
                        </div>
                    </div>

                    <div class="msg-group" id="chat-17-1">
                        <div class="msg-meta"><span>Page 17</span><span>â€¢</span><span>ì¹˜ë£Œ</span></div>
                        <div class="bubble user-msg">ì´ˆê¸° ìˆ˜ì•¡ì€ ë­˜ë¡œ ì¤˜?</div>
                        <div class="bubble ai-msg" draggable="true" ondragstart="drag(event)">
                            ì‡¼í¬ê°€ ì—†ë‹¤ë©´ <strong>0.9% Normal Saline</strong>ì„ ì²« 1ì‹œê°„ ë™ì•ˆ 1,000mL (15-20mL/kg) íˆ¬ì—¬í•˜ëŠ” ê²ƒì´ ì›ì¹™ì…ë‹ˆë‹¤.
                        </div>
                    </div>

                    <div class="msg-group" id="chat-18-1">
                        <div class="msg-meta"><span>Page 18</span><span>â€¢</span><span>ì£¼ì˜ì‚¬í•­</span></div>
                        <div class="bubble user-msg">K ìˆ˜ì¹˜ 3.0ì¸ë° ì¸ìŠë¦° ì£¼ë©´?</div>
                        <div class="bubble ai-msg" draggable="true" ondragstart="drag(event)">
                            <strong>ì ˆëŒ€ ì•ˆ ë©ë‹ˆë‹¤!</strong><br>
                            ì¸ìŠë¦°ì´ Kë¥¼ ì„¸í¬ ì•ˆìœ¼ë¡œ ë°€ì–´ë„£ì–´ ìˆ˜ì¹˜ê°€ ë” ë–¨ì–´ì§€ë©´ í˜¸í¡ê·¼ ë§ˆë¹„ë‚˜ <strong>ì‹¬ì‹¤ ë¶€ì •ë§¥(V-fib)</strong>ìœ¼ë¡œ ì‚¬ë§í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë°˜ë“œì‹œ K ë³´ì¶© í›„ 3.3 ì´ìƒì¼ ë•Œ ì¸ìŠë¦°ì„ ì‹œì‘í•˜ì„¸ìš”.
                        </div>
                    </div>

                    </div>
            </div>

            <div id="tab-jokbo" class="tab-content">
                <div style="font-size:12px; color:#888; margin-bottom:15px;">â€» ìµœê·¼ 5ê°œë…„ ê¸°ì¶œë¬¸ì œ ê¸°ë°˜</div>

                <div class="jokbo-card p13-item visible">
                    <div class="badge-row"><span class="badge year">23ë…„ 2ì°¨</span><span class="badge freq">â˜…ë¹ˆì¶œ</span></div>
                    <div class="q-body">Q. ì œ1í˜• ë‹¹ë‡¨ë³‘ í™˜ìì—ì„œ DKA ë°œìƒ ì‹œ ì¦ê°€í•˜ëŠ” í˜¸ë¥´ëª¬ì´ ì•„ë‹Œ ê²ƒì€?</div>
                    <div class="q-options">
                        <div>â‘  Glucagon</div>
                        <div>â‘¡ Cortisol</div>
                        <div>â‘¢ Growth Hormone</div>
                        <div>â‘£ <strong>Insulin</strong> (ì •ë‹µ)</div>
                        <div>â‘¤ Catecholamine</div>
                    </div>
                </div>

                <div class="jokbo-card p14-item">
                    <div class="badge-row"><span class="badge year">22ë…„ KMLE</span><span class="badge tag">ê°ë³„ì§„ë‹¨</span></div>
                    <div class="q-body">Q. 24ì„¸ ì—¬ìê°€ ë³µí†µê³¼ ì˜¤ì‹¬ì„ ì£¼ì†Œë¡œ ë‚´ì›í–ˆë‹¤. ë³µë¶€ CTëŠ” ì •ìƒì´ì—ˆìœ¼ë‚˜, í˜¸í¡ì´ ê¹Šê³  ë¹¨ëë‹¤. ê°€ì¥ ë¨¼ì € ì‹œí–‰í•  ê²€ì‚¬ëŠ”?</div>
                    <div class="q-options">
                        <div>â‘  ìœ„ë‚´ì‹œê²½</div>
                        <div>â‘¡ <strong>ìê°€í˜ˆë‹¹ ì¸¡ì • ë° ì†Œë³€ ì¼€í†¤</strong> (ì •ë‹µ)</div>
                        <div>â‘¢ ë³µë¶€ ì´ˆìŒíŒŒ</div>
                    </div>
                </div>

                <div class="jokbo-card p16-item">
                    <div class="badge-row"><span class="badge year">24ë…„ 1ì°¨</span><span class="badge freq">ê³„ì‚°ë¬¸ì œ</span></div>
                    <div class="q-body">Q. ë‹¤ìŒ í™˜ìì˜ Anion Gapì€?<br>Na 135, K 4.0, Cl 98, HCO3 10</div>
                    <div class="q-lab">AG = 135 - (98 + 10) = 27</div>
                    <div class="q-options">
                        <div>â‘  12</div>
                        <div>â‘¡ 17</div>
                        <div>â‘¢ <strong>27</strong> (ì •ë‹µ)</div>
                    </div>
                </div>

                <div class="jokbo-card p18-item">
                    <div class="badge-row"><span class="badge year">21ë…„ KMLE</span><span class="badge freq">â˜…â˜…â˜…í•„ìˆ˜</span></div>
                    <div class="q-body">Q. DKA í™˜ì ì¹˜ë£Œ ì¤‘ì´ë‹¤. pH 7.1, Glucose 400, K+ 2.8 mEq/L ì´ë‹¤. ì²˜ì¹˜ëŠ”?</div>
                    <div class="q-options">
                        <div>â‘  ì¸ìŠë¦° ì¦ëŸ‰</div>
                        <div>â‘¡ ì¤‘íƒ„ì‚°ì—¼ íˆ¬ì—¬</div>
                        <div>â‘¢ <strong>ì¸ìŠë¦° ë³´ë¥˜ ë° KCl íˆ¬ì—¬</strong> (ì •ë‹µ)</div>
                    </div>
                </div>

                 <div class="jokbo-card p21-item">
                    <div class="badge-row"><span class="badge year">20ë…„ KMLE</span><span class="badge tag">ê°ë³„</span></div>
                    <div class="q-body">Q. HHSì™€ DKAì˜ ê°ë³„ì ì—ì„œ HHSì˜ íŠ¹ì§•ìœ¼ë¡œ ì˜³ì€ ê²ƒì€?</div>
                    <div class="q-options">
                        <div>â‘  pH < 7.3</div>
                        <div>â‘¡ <strong>Serum Osmolality > 320</strong> (ì •ë‹µ)</div>
                        <div>â‘¢ Urine Ketone (+++)</div>
                    </div>
                </div>
            </div>

            <div id="tab-script" class="tab-content">
                <div class="script-segment" id="script-13-1">
                    <div class="script-header"><span class="speaker-name">êµìˆ˜ë‹˜</span><span>09:30</span></div>
                    <div class="script-text">
                        ì, ì˜¤ëŠ˜ ìˆ˜ì—…ì€ <span class="highlight-text">DKA(ë‹¹ë‡¨ë³‘ì„± ì¼€í†¤ì‚°ì¦)</span>ì…ë‹ˆë‹¤. ì‘ê¸‰ì‹¤ì—ì„œ ì¸í„´ ë•Œ ê°€ì¥ ë§ì´ ë³´ê²Œ ë  ì¼€ì´ìŠ¤ì˜ˆìš”.
                        í•µì‹¬ì€ ì¸ìŠë¦°ì´ 'ì•„ì˜ˆ' ì—†ë‹¤ëŠ” ê²ë‹ˆë‹¤. ê·¸ë˜ì„œ ìš°ë¦¬ ëª¸ì´ ì§€ë°©ì„ íƒœìš°ê³ , ê·¸ ì°Œêº¼ê¸°ë¡œ 'ì¼€í†¤'ì´ ë‚˜ì™€ì„œ í”¼ê°€ ì‚°ì„±ì´ ë˜ëŠ” ê±°ì£ .
                    </div>
                </div>
                <div class="script-segment" id="script-15-1">
                    <div class="script-header"><span class="speaker-name">êµìˆ˜ë‹˜</span><span>09:45</span></div>
                    <div class="script-text">
                        í™˜ìê°€ ë“¤ì–´ì˜¤ëŠ”ë° ì…ì—ì„œ ìˆ  ëƒ„ìƒˆ ê°™ì€ ë‹¬ë‹¬í•œ ê³¼ì¼ í–¥ì´ ë‚œë‹¤? ê·¸ë¦¬ê³  ìˆ¨ì„ í—ë–¡ì¸ë‹¤? (Kussmaul breathing)
                        ê·¸ëŸ¬ë©´ 100%ì…ë‹ˆë‹¤. ê·¸ë¦¬ê³  <strong>ë°° ì•„í”„ë‹¤ê³  ë‹¤ ë§¹ì¥ì—¼ ì•„ë‹™ë‹ˆë‹¤.</strong> DKA í™˜ì ì ˆë°˜ì´ ë³µí†µ í˜¸ì†Œí•´ìš”. ì˜¤ì§„í•˜ë©´ í°ì¼ ë‚©ë‹ˆë‹¤.
                    </div>
                </div>
                <div class="script-segment" id="script-17-1">
                    <div class="script-header"><span class="speaker-name">êµìˆ˜ë‹˜</span><span>10:10</span></div>
                    <div class="script-text">
                        ì¹˜ë£Œ í”„ë¡œí† ì½œ ì™¸ìš°ì„¸ìš”. <span class="highlight-text">Fluid First!</span> ì¸ìŠë¦°ë¶€í„° ì°¾ëŠ” í•™ìƒë“¤ ìˆëŠ”ë°, í™˜ì íƒˆìˆ˜ë¶€í„° êµì • ì•ˆ í•˜ë©´ ì‡¼í¬ ì˜µë‹ˆë‹¤.
                        ìƒë¦¬ì‹ì—¼ìˆ˜(NS) 1ë¦¬í„°ë¥¼ ì²« 1ì‹œê°„ì— ì½¸ì½¸ ë¶€ì–´ì£¼ì„¸ìš”.
                    </div>
                </div>
                <div class="script-segment" id="script-18-1">
                    <div class="script-header"><span class="speaker-name">êµìˆ˜ë‹˜</span><span>10:25</span></div>
                    <div class="script-text">
                        ì—¬ê¸° ë³„í‘œ ë‹¤ì„¯ ê°œ ì¹˜ì„¸ìš”. <strong>K ìˆ˜ì¹˜ ì•ˆ ë³´ê³  ì¸ìŠë¦° ì£¼ë©´ ì‚´ì¸ì…ë‹ˆë‹¤.</strong>
                        ì¸ìŠë¦°ì´ ë“¤ì–´ê°€ë©´ Kê°€ ì„¸í¬ ì•ˆìœ¼ë¡œ ìˆ¨ì–´ë²„ë ¤ìš”. ê·¸ëŸ¼ í˜ˆì¤‘ Kê°€ ëš ë–¨ì–´ì ¸ì„œ ì‹¬ì¥ ë©ìŠµë‹ˆë‹¤. 3.3 ê¸°ì–µí•˜ì„¸ìš”.
                    </div>
                </div>
                <div class="script-segment" id="script-20-1">
                    <div class="script-header"><span class="speaker-name">êµìˆ˜ë‹˜</span><span>10:40</span></div>
                    <div class="script-text">
                        ì†Œì•„ê³¼ ë„ëŠ” í•™ìƒë“¤ ì˜ ë“¤ìœ¼ì„¸ìš”. ì¹˜ë£Œ ì˜ í•˜ë‹¤ê°€ ì• ê°€ ê°‘ìê¸° ë¨¸ë¦¬ ì•„í”„ë‹¤ê³  í•˜ê³  í† í•˜ë©´ <strong>ë‡Œë¶€ì¢…(Cerebral Edema)</strong> ì˜ì‹¬í•´ì•¼ í•©ë‹ˆë‹¤. 
                        ìˆ˜ì•¡ ë„ˆë¬´ ë¹¨ë¦¬ ì¤˜ì„œ ê·¸ë˜ìš”. ë°”ë¡œ ë§Œë‹ˆí†¨(Mannitol) ë‹¬ì•„ì•¼ í•©ë‹ˆë‹¤.
                    </div>
                </div>
                <div class="script-segment" id="script-22-1">
                    <div class="script-header"><span class="speaker-name">êµìˆ˜ë‹˜</span><span>11:00</span></div>
                    <div class="script-text">
                        ë§ˆì§€ë§‰ìœ¼ë¡œ Sick Day Rule. í™˜ìê°€ ê°ê¸° ê±¸ë ¤ì„œ ë°¥ ëª» ë¨¹ì—ˆë‹¤ê³  ì¸ìŠë¦° ëŠê³  ì‘ê¸‰ì‹¤ ì‹¤ë ¤ì˜µë‹ˆë‹¤. 
                        ì•„íŒŒì„œ ìŠ¤íŠ¸ë ˆìŠ¤ ë°›ìœ¼ë©´ í˜ˆë‹¹ ë” ì˜¤ë¥´ë‹ˆê¹Œ, <strong>ì£¼ì‚¬ ì ˆëŒ€ ëŠì§€ ë§ë¼</strong>ê³  êµìœ¡í•´ì•¼ í•©ë‹ˆë‹¤.
                    </div>
                </div>
            </div>
        </div>

        <div class="audio-player-bar" id="audioPlayer">
            <div class="play-btn">â–¶</div>
            <div class="timeline-box">
                <div class="timeline-bg"><div class="timeline-fill" id="audioProgress"></div></div>
                <div class="time-labels"><span id="currentTime">09:30</span><span>12:00</span></div>
            </div>
            <div class="speed-control" style="font-weight:700; color:#555; cursor:pointer;">1.2x</div>
        </div>
    </div>
</div>

<script>
    // [10í˜ì´ì§€ ë°ì´í„° ì„¤ì •]
    const pages = ['p13', 'p14', 'p15', 'p16', 'p17', 'p18', 'p19', 'p20', 'p21', 'p22'];
    let currentPageIdx = 0;

    // [í˜ì´ì§€ ë³€ê²½ ë¡œì§]
    function changePage(direction) {
        const nextIdx = currentPageIdx + direction;
        if (nextIdx < 0 || nextIdx >= pages.length) return;

        document.getElementById(pages[currentPageIdx]).classList.remove('active');
        currentPageIdx = nextIdx;
        const newPageId = pages[currentPageIdx];
        document.getElementById(newPageId).classList.add('active');
        
        const pageNum = newPageId.replace('p', '');
        document.getElementById('headerPageNum').innerText = `Page ${pageNum} / 60`;
        
        document.querySelector('.nav-prev').classList.toggle('disabled', currentPageIdx === 0);
        document.querySelector('.nav-next').classList.toggle('disabled', currentPageIdx === pages.length - 1);

        syncRightPanel(pageNum);
    }

    // [ì»¨í…ì¸  ë™ê¸°í™” ë§¤í•‘]
    function syncRightPanel(pageNum) {
        // ì¡±ë³´ í•„í„°ë§
        document.querySelectorAll('.jokbo-card').forEach(card => card.classList.remove('visible'));
        document.querySelectorAll(`.p${pageNum}-item`).forEach(card => card.classList.add('visible'));

        // ë°ì´í„° ë§¤í•‘
        const syncMap = {
            '13': { chat: 'chat-13-1', script: 'script-13-1', time: '09:30', progress: '10%' },
            '14': { chat: 'chat-14-1', script: 'script-13-1', time: '09:40', progress: '15%' }, // 13ë²ˆ ìŠ¤í¬ë¦½íŠ¸ ì—°ì¥
            '15': { chat: 'chat-15-1', script: 'script-15-1', time: '09:45', progress: '25%' },
            '16': { chat: 'chat-16-1', script: 'script-15-1', time: '09:55', progress: '30%' },
            '17': { chat: 'chat-17-1', script: 'script-17-1', time: '10:10', progress: '40%' },
            '18': { chat: 'chat-18-1', script: 'script-18-1', time: '10:25', progress: '50%' },
            '19': { chat: 'chat-18-1', script: 'script-18-1', time: '10:30', progress: '55%' },
            '20': { chat: 'chat-18-1', script: 'script-20-1', time: '10:40', progress: '65%' },
            '21': { chat: 'chat-18-1', script: 'script-20-1', time: '10:50', progress: '75%' },
            '22': { chat: 'chat-18-1', script: 'script-22-1', time: '11:00', progress: '90%' }
        };

        const target = syncMap[pageNum];
        if (target) {
            const activeTabId = document.querySelector('.tab-content.active').id;
            let targetElId = null;
            if (activeTabId === 'tab-chat') targetElId = target.chat;
            else if (activeTabId === 'tab-script') targetElId = target.script;
            
            if (targetElId) {
                const targetEl = document.getElementById(targetElId);
                if (targetEl) {
                    const container = document.querySelector('.tab-content-container');
                    container.scrollTo({ top: targetEl.offsetTop - 20, behavior: 'smooth' });
                    highlightEffect(targetEl);
                }
            }
            document.getElementById('currentTime').innerText = target.time;
            document.getElementById('audioProgress').style.width = target.progress;
        }
    }

    function highlightEffect(element) {
        document.querySelectorAll('.active-context-bg').forEach(el => el.classList.remove('active-context-bg'));
        element.classList.add('active-context-bg');
        setTimeout(() => { element.classList.remove('active-context-bg'); }, 2000);
    }

    // [íƒ­ ì „í™˜]
    function showTab(tabId) {
        document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
        document.getElementById(tabId).classList.add('active');
        
        document.querySelectorAll('.tab').forEach(el => el.classList.remove('active'));
        const tabs = ['tab-chat', 'tab-jokbo', 'tab-script'];
        document.querySelectorAll('.tab')[tabs.indexOf(tabId)].classList.add('active');

        const player = document.getElementById('audioPlayer');
        if (tabId === 'tab-script') player.classList.add('visible');
        else player.classList.remove('visible');
        
        const currentPageNum = pages[currentPageIdx].replace('p', '');
        syncRightPanel(currentPageNum);
    }

    // [Drag & Drop]
    function drag(ev) { ev.dataTransfer.setData("chatId", ev.target.id); ev.dataTransfer.setData("text", ev.target.innerText); }
    function allowDrop(ev) { ev.preventDefault(); }
    function drop(ev) {
        ev.preventDefault();
        const chatId = ev.dataTransfer.getData("chatId"); 
        const tempDiv = document.createElement("div"); tempDiv.innerHTML = ev.dataTransfer.getData("text");
        const cleanText = tempDiv.textContent || tempDiv.innerText || "";
        const rect = ev.currentTarget.getBoundingClientRect();
        
        const note = document.createElement("div");
        note.className = "dropped-note"; 
        note.innerHTML = `ğŸ“Œ <strong>AI ë©”ëª¨</strong><br>${cleanText.substring(0, 30)}...`;
        note.style.left = (ev.clientX - rect.left) + "px"; 
        note.style.top = (ev.clientY - rect.top) + "px";
        note.onclick = () => focusChat(chatId);
        
        ev.currentTarget.appendChild(note);
    }

    function focusChat(elementId) {
        showTab('tab-chat');
        const el = document.getElementById(elementId);
        if(el) {
            document.querySelector('.tab-content-container').scrollTo({ top: el.offsetTop - 80, behavior: 'smooth' });
            highlightEffect(el);
        }
    }
</script>
</body>
</html>
