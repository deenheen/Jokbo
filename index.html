<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Study: ì¡±ë³´ & ê°•ì˜ ì—°ë™ ì‹œìŠ¤í…œ</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary: #5c6bc0;       /* ë©”ì¸ ì»¬ëŸ¬ */
            --secondary: #e8eaf6;     /* ë°°ê²½ ì»¬ëŸ¬ */
            --accent-jokbo: #2ecc71;  /* ì¡±ë³´ ë§¤ì¹­ ì»¬ëŸ¬ (ì´ˆë¡ìƒ‰, ì´ë¯¸ì§€ ì°¸ê³ ) */
            --accent-ai: #ff9800;     /* AI ë‹µë³€ ì»¬ëŸ¬ */
            --text-dark: #333;
            --border: #ddd;
        }

        * { box-sizing: border-box; }

        body {
            margin: 0;
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, sans-serif;
            height: 100vh;
            display: flex;
            background-color: #f0f2f5;
            overflow: hidden;
        }

        /* --- ì™¼ìª½: ê°•ì˜ë¡ ë·°ì–´ (PDF ì‹œë®¬ë ˆì´ì…˜) --- */
        .viewer-section {
            flex: 1.5;
            padding: 30px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            align-items: center;
            scroll-behavior: smooth;
        }

        .pdf-page {
            width: 100%;
            max-width: 800px;
            background: white;
            padding: 50px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            position: relative;
            transition: transform 0.3s;
        }

        .pdf-page h2 { color: var(--primary); border-bottom: 2px solid var(--secondary); padding-bottom: 10px; }
        .pdf-page p, .pdf-page li { line-height: 1.8; color: #444; font-size: 16px; margin-bottom: 15px; }
        
        /* ì¡±ë³´ ë§¤ì¹­ í•˜ì´ë¼ì´íŠ¸ íš¨ê³¼ (ì²˜ìŒì—” ìˆ¨ê¹€) */
        .match-highlight {
            background-color: transparent;
            border-bottom: 2px solid transparent;
            transition: all 0.5s ease;
            cursor: pointer;
            position: relative;
        }

        /* í™œì„±í™” ì‹œ ìŠ¤íƒ€ì¼ */
        .match-highlight.active {
            background-color: rgba(46, 204, 113, 0.2); /* ì—°í•œ ì´ˆë¡ ë°°ê²½ */
            border-bottom: 2px solid var(--accent-jokbo);
            font-weight: 600;
        }

        /* íˆ´íŒ (ì¡±ë³´ ë¬¸ì œ ë³´ì—¬ì£¼ê¸°) */
        .match-highlight:hover::after {
            content: attr(data-question);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: #333;
            color: white;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 12px;
            width: 250px;
            z-index: 10;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            pointer-events: none;
        }

        /* --- ì˜¤ë¥¸ìª½: ìŠ¤ë§ˆíŠ¸ ì‚¬ì´ë“œë°” --- */
        .sidebar {
            flex: 1;
            max-width: 450px;
            background: white;
            border-left: 1px solid var(--border);
            display: flex;
            flex-direction: column;
        }

        /* ì‚¬ì´ë“œë°” í—¤ë” íƒ­ */
        .tabs {
            display: flex;
            border-bottom: 1px solid var(--border);
            background: #fafafa;
        }
        .tab-btn {
            flex: 1;
            padding: 15px;
            border: none;
            background: transparent;
            cursor: pointer;
            font-weight: 600;
            color: #777;
            transition: 0.2s;
        }
        .tab-btn.active {
            color: var(--primary);
            border-bottom: 3px solid var(--primary);
            background: white;
        }
        .tab-btn i { margin-right: 5px; }

        /* íƒ­ ì½˜í…ì¸  ì˜ì—­ */
        .tab-content {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            display: none; /* ê¸°ë³¸ ìˆ¨ê¹€ */
        }
        .tab-content.active { display: flex; flex-direction: column; }

        /* 1. ì¡±ë³´ ë§¤ì¹­ ë¦¬ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ */
        .jokbo-list-item {
            background: white;
            border: 1px solid #eee;
            border-left: 4px solid var(--accent-jokbo);
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 6px;
            cursor: pointer;
            transition: 0.2s;
        }
        .jokbo-list-item:hover {
            transform: translateX(5px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .q-tag { font-size: 11px; background: #eee; padding: 2px 6px; border-radius: 4px; color: #555; }
        .q-text { font-size: 14px; font-weight: bold; margin-top: 5px; display: block;}

        /* 2. ì±„íŒ… UI ìŠ¤íƒ€ì¼ */
        .chat-container { flex: 1; display: flex; flex-direction: column; }
        .chat-messages { flex: 1; overflow-y: auto; padding-bottom: 20px; }
        
        .message { margin-bottom: 15px; max-width: 90%; font-size: 14px; line-height: 1.5; position: relative; }
        .message.ai { align-self: flex-start; }
        .message.user { align-self: flex-end; margin-left: auto; background: var(--primary); color: white; padding: 10px 15px; border-radius: 12px 12px 0 12px; }
        
        .ai-bubble {
            background: #f1f3f8;
            padding: 15px;
            border-radius: 12px 12px 12px 0;
            color: #333;
        }
        .ai-source {
            font-size: 11px; color: #666; margin-top: 5px; display: flex; align-items: center; gap: 5px;
        }
        
        /* ë“œë˜ê·¸/ì €ì¥ ë²„íŠ¼ (AI ë‹µë³€ ë‚´) */
        .save-snippet-btn {
            background: white; border: 1px solid #ddd; padding: 2px 8px; border-radius: 12px; cursor: pointer; font-size: 11px; margin-left: auto;
        }
        .save-snippet-btn:hover { background: var(--secondary); color: var(--primary); }

        .input-area {
            display: flex; gap: 10px; padding-top: 15px; border-top: 1px solid #eee;
        }
        .input-area input {
            flex: 1; padding: 10px; border: 1px solid #ddd; border-radius: 20px; outline: none;
        }
        .send-btn {
            background: var(--primary); color: white; border: none; width: 40px; height: 40px; border-radius: 50%; cursor: pointer;
        }

        /* 3. ì €ì¥ëœ ë…¸íŠ¸ ìŠ¤íƒ€ì¼ */
        .saved-card {
            background: #fff;
            border: 1px solid #e0e0e0;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 12px;
            position: relative;
            cursor: pointer;
        }
        .saved-card::before {
            content: ''; position: absolute; left: 0; top: 10px; bottom: 10px; width: 4px; background: var(--accent-ai); border-radius: 0 4px 4px 0;
        }
        .saved-card.jokbo-type::before { background: var(--accent-jokbo); } /* ì¡±ë³´ ì €ì¥ì€ ì´ˆë¡ìƒ‰ */

        /* ìœ í‹¸ë¦¬í‹° */
        .focus-anim { animation: flash 1.5s ease; }
        @keyframes flash {
            0% { background-color: rgba(255, 235, 59, 0.5); }
            100% { background-color: transparent; }
        }

        .upload-btn {
            width: 100%; padding: 12px; background: #333; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-bottom: 15px;
        }
        .upload-btn:hover { background: #555; }

    </style>
</head>
<body>

    <div class="viewer-section" id="viewer">
        <div class="pdf-page" id="page-1">
            <div style="float:right; color:#999; font-size:12px;">Page 1</div>
            <h2>Evidence That Viral DNA Can Program Cells</h2>
            <ul>
                <li>More evidence for DNA as the genetic material came from studies of viruses that infect bacteria.</li>
                <li>Such viruses, called 
                    <span class="match-highlight" id="ctx-phage" data-question="Q14. What are Bacteriophages used for in molecular genetics?">
                        bacteriophages (or phages)
                    </span>, are widely used in molecular genetics research.
                </li>
                <li>A virus is DNA (or RNA) enclosed by a protective protein coat.</li>
                <li id="ctx-reproduce">Viruses must infect cells and take over the cells' metabolic machinery in order to reproduce.</li>
            </ul>
            <div style="background:#f9f9f9; padding:15px; margin-top:20px; border-radius:8px;">
                <strong>Key Experiment:</strong> Hershey and Chase designed an experiment showing that only the DNA of the T2 phage, and not the protein, enters an <em>E. coli</em> cell during infection.
            </div>
        </div>

        <div class="pdf-page" id="page-2">
            <div style="float:right; color:#999; font-size:12px;">Page 2</div>
            <h2>The Cell Cycle & Mitosis</h2>
            <p>
                In 
                <span class="match-highlight" id="ctx-mitosis" data-question="Q8. ì•”ì´ ì¦ì‹í•˜ëŠ” ë°ì— Mitosisê°€ í™œìš©ë˜ë‚˜?">
                    mitosis
                </span>, the genetic material is divided equally into two new nuclei.
            </p>
            <ul>
                <li><strong>Prophase:</strong> Chromatin condenses into chromosomes.</li>
                <li>
                    <strong>Metaphase:</strong> Chromosomes line up at the metaphase plate. 
                    <span class="match-highlight" id="ctx-meta" data-question="Q14. In mitosis, how many chromosomes (N) are in the cell on metaphase?">
                        (Checkpoint for spindle attachment)
                    </span>
                </li>
                <li><strong>Anaphase:</strong> Sister chromatids separate.</li>
            </ul>
            <p id="ctx-membrane">
                The cell membrane plays a crucial role in cytokinesis, pinching the cell into two daughter cells.
            </p>
        </div>
    </div>

    <div class="sidebar">
        <div class="tabs">
            <button class="tab-btn active" onclick="setTab('jokbo')"><i class="fas fa-list-check"></i> ì¡±ë³´ ë§¤ì¹­</button>
            <button class="tab-btn" onclick="setTab('chat')"><i class="fas fa-robot"></i> AI íŠœí„°</button>
            <button class="tab-btn" onclick="setTab('saved')"><i class="fas fa-bookmark"></i> ì €ì¥ë¨ <span id="save-count" style="font-size:10px; background:red; color:white; padding:2px 5px; border-radius:10px; display:none;">0</span></button>
        </div>

        <div id="tab-jokbo" class="tab-content active">
            <button class="upload-btn" onclick="analyzeJokbo()">
                <i class="fas fa-file-upload"></i> ì¡±ë³´ íŒŒì¼ ì—…ë¡œë“œ (Demo)
            </button>
            
            <div id="jokbo-results" style="display:none;">
                <div style="font-size:12px; color:#666; margin-bottom:10px;">
                    ì´ <b style="color:var(--accent-jokbo)">3ê°œ</b>ì˜ ì—°ê´€ëœ ë‚´ìš©ì„ ì°¾ì•˜ìŠµë‹ˆë‹¤.
                </div>

                <div class="jokbo-list-item" onclick="jumpTo('ctx-mitosis')">
                    <span class="q-tag">2024 ì¤‘ê°„ê³ ì‚¬ Q8</span>
                    <span class="q-text">ì•”ì´ ì¦ì‹í•˜ëŠ” ë°ì— Mitosisê°€ í™œìš©ë˜ë‚˜?</span>
                    <div style="margin-top:8px; font-size:12px; color:#666;">
                        <i class="fas fa-link"></i> Page 2 ì—°ê²°ë¨
                        <button class="save-snippet-btn" onclick="saveItem('ì¡±ë³´', 'ì•” ì¦ì‹ê³¼ Mitosis ê´€ê³„', 'page-2'); event.stopPropagation();">ì €ì¥</button>
                    </div>
                </div>

                <div class="jokbo-list-item" onclick="jumpTo('ctx-meta')">
                    <span class="q-tag">2023 ê¸°ë§ê³ ì‚¬ Q14</span>
                    <span class="q-text">Metaphaseì˜ ì—¼ìƒ‰ì²´ ìˆ˜ì™€ DNA í•¨ëŸ‰ì€?</span>
                    <div style="margin-top:8px; font-size:12px; color:#666;">
                        <i class="fas fa-link"></i> Page 2 ì—°ê²°ë¨
                        <button class="save-snippet-btn" onclick="saveItem('ì¡±ë³´', 'Metaphase ì—¼ìƒ‰ì²´ ìˆ˜ ê³„ì‚°', 'page-2'); event.stopPropagation();">ì €ì¥</button>
                    </div>
                </div>

                <div class="jokbo-list-item" onclick="jumpTo('ctx-phage')">
                    <span class="q-tag">ì„œìˆ í˜• Q1</span>
                    <span class="q-text">Bacteriophagesì˜ ì—­í•  ì„œìˆ </span>
                    <div style="margin-top:8px; font-size:12px; color:#666;">
                        <i class="fas fa-link"></i> Page 1 ì—°ê²°ë¨
                        <button class="save-snippet-btn" onclick="saveItem('ì¡±ë³´', 'Bacteriophages ì •ì˜', 'page-1'); event.stopPropagation();">ì €ì¥</button>
                    </div>
                </div>
            </div>
            
            <div id="jokbo-placeholder" style="text-align:center; margin-top:50px; color:#999;">
                <i class="fas fa-file-pdf" style="font-size:40px; margin-bottom:10px;"></i><br>
                ì¡±ë³´ PDFë‚˜ ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•˜ë©´<br>ê°•ì˜ë¡ê³¼ ë¹„êµ ë¶„ì„í•©ë‹ˆë‹¤.
            </div>
        </div>

        <div id="tab-chat" class="tab-content">
            <div class="chat-container">
                <div class="chat-messages" id="chat-box">
                    <div class="message ai">
                        <div class="ai-bubble">
                            ì•ˆë…•í•˜ì„¸ìš”! ê°•ì˜ë¡ê³¼ ì¡±ë³´ë¥¼ ëª¨ë‘ í•™ìŠµí–ˆìŠµë‹ˆë‹¤.<br>
                            ê¶ê¸ˆí•œ ì ì„ ë¬¼ì–´ë³´ì‹œê±°ë‚˜, <b>"ì¡±ë³´ ìš”ì•½í•´ì¤˜"</b>ë¼ê³  í•´ë³´ì„¸ìš”.
                        </div>
                    </div>
                </div>
                <div class="input-area">
                    <input type="text" id="chat-input" placeholder="ì§ˆë¬¸ì„ ì…ë ¥í•˜ì„¸ìš”..." onkeypress="handleKey(event)">
                    <button class="send-btn" onclick="sendMessage()"><i class="fas fa-paper-plane"></i></button>
                </div>
            </div>
        </div>

        <div id="tab-saved" class="tab-content">
            <div id="saved-list">
                <div style="text-align:center; color:#999; margin-top:50px;">
                    <i class="far fa-bookmark" style="font-size:30px; margin-bottom:10px;"></i><br>
                    ì¤‘ìš”í•œ ì¡±ë³´ ë¬¸ì œë‚˜<br>AI ë‹µë³€ì„ ì €ì¥í•´ë³´ì„¸ìš”.
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- 1. íƒ­ ì „í™˜ ë¡œì§ ---
        function setTab(tabName) {
            // ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì´ˆê¸°í™” & ì„¤ì •
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            event.currentTarget.classList.add('active'); // í´ë¦­ëœ ë²„íŠ¼ í™œì„±í™” (ì£¼ì˜: event ê°ì²´ ì‚¬ìš©)

            // ì½˜í…ì¸  ì´ˆê¸°í™” & ì„¤ì •
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            document.getElementById(`tab-${tabName}`).classList.add('active');

            // íƒ­ ë²„íŠ¼ í´ë¦­ ì‹œ event.currentTargetì„ ì¡ê¸° ìœ„í•´ html onclickì—ì„œ í•¨ìˆ˜ í˜¸ì¶œ ì‹œ ìˆ˜ì • í•„ìš”í•  ìˆ˜ ìˆìŒ
            // í•˜ì§€ë§Œ í˜„ì¬ êµ¬ì¡°ìƒ ìœ„ ì½”ë“œëŠ” ì‘ë™í•¨. ë” ì•ˆì „í•˜ê²Œ í•˜ê¸° ìœ„í•´ ì¸ë±ìŠ¤ë¡œ ì²˜ë¦¬ ê°€ëŠ¥.
            const buttons = document.querySelectorAll('.tab-btn');
            if(tabName === 'jokbo') buttons[0].classList.add('active');
            if(tabName === 'chat') buttons[1].classList.add('active');
            if(tabName === 'saved') buttons[2].classList.add('active');
        }

        // --- 2. ì¡±ë³´ ë¶„ì„ ì‹œë®¬ë ˆì´ì…˜ ---
        function analyzeJokbo() {
            const btn = document.querySelector('.upload-btn');
            const placeholder = document.getElementById('jokbo-placeholder');
            const results = document.getElementById('jokbo-results');

            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> ë¶„ì„ ì¤‘...';
            
            setTimeout(() => {
                btn.innerHTML = '<i class="fas fa-check"></i> ë¶„ì„ ì™„ë£Œ';
                btn.style.background = '#2ecc71';
                placeholder.style.display = 'none';
                results.style.display = 'block';

                // ê°•ì˜ë¡ ë‚´ í•˜ì´ë¼ì´íŠ¸ í™œì„±í™”
                document.querySelectorAll('.match-highlight').forEach(el => {
                    el.classList.add('active');
                    // í´ë¦­ ì‹œ í•´ë‹¹ ë¬¸ì œ ì •ë³´ í‘œì‹œ (alert ëŒ€ì‹  ì½˜ì†”ì´ë‚˜ UIë¡œ í™•ì¥ ê°€ëŠ¥)
                    el.onclick = function() {
                        alert("ì—°ê´€ ë¬¸ì œ: " + this.getAttribute('data-question'));
                    }
                });

                // ì‚¬ìš©ìì—ê²Œ ì•Œë¦¼
                alert("ë¶„ì„ ì™„ë£Œ! ê°•ì˜ë¡ì— ì¶œì œ ë¹ˆë„ê°€ ë†’ì€ ë¶€ë¶„ì´ ì´ˆë¡ìƒ‰ìœ¼ë¡œ í‘œì‹œë˜ì—ˆìŠµë‹ˆë‹¤.");
            }, 1500);
        }

        // --- 3. ë”¥ ë§í‚¹ (Deep Linking) & ìŠ¤í¬ë¡¤ ---
        function jumpTo(elementId) {
            const target = document.getElementById(elementId);
            if (target) {
                target.scrollIntoView({ behavior: 'smooth', block: 'center' });
                target.classList.add('focus-anim');
                setTimeout(() => target.classList.remove('focus-anim'), 2000);
            }
        }

        // --- 4. AI ì±„íŒ… ë¡œì§ ---
        function handleKey(e) {
            if (e.key === 'Enter') sendMessage();
        }

        function sendMessage() {
            const input = document.getElementById('chat-input');
            const text = input.value.trim();
            if (!text) return;

            // ìœ ì € ë©”ì‹œì§€ ì¶”ê°€
            addMessage('user', text);
            input.value = '';

            // AI ì‘ë‹µ ì‹œë®¬ë ˆì´ì…˜
            setTimeout(() => {
                let reply = "";
                let sourcePage = "";

                if (text.includes("ì¡±ë³´") || text.includes("ìš”ì•½")) {
                    reply = "ì´ë²ˆ ì¡±ë³´ ë¶„ì„ ê²°ê³¼, <b>Mitosis(ìœ ì‚¬ë¶„ì—´)</b>ì™€ <b>Bacteriophages</b> ê´€ë ¨ ë¬¸ì œê°€ ê°€ì¥ ë§ì´ ì¶œì œë˜ì—ˆìŠµë‹ˆë‹¤. íŠ¹íˆ 2í˜ì´ì§€ì˜ Metaphase ë‹¨ê³„ì—ì„œ ì—¼ìƒ‰ì²´ ìˆ˜ë¥¼ ë¬»ëŠ” í•¨ì • ë¬¸ì œê°€ ìì£¼ ë‚˜ì˜µë‹ˆë‹¤.";
                    sourcePage = "page-2";
                } else if (text.includes("Mitosis") || text.includes("ë¶„ì—´")) {
                    reply = "MitosisëŠ” ì„¸í¬ ì£¼ê¸° ì¤‘ í•µì´ ë¶„ì—´í•˜ëŠ” ê³¼ì •ì…ë‹ˆë‹¤. ì¡±ë³´(Q8)ì— ë”°ë¥´ë©´ ì•”ì„¸í¬ ì¦ì‹ ê¸°ì „ê³¼ ì—°ê´€ì§€ì–´ ì„œìˆ í•˜ëŠ” ë¬¸ì œê°€ ì¶œì œë˜ì—ˆìŠµë‹ˆë‹¤.";
                    sourcePage = "page-2";
                } else if (text.includes("ë°”ì´ëŸ¬ìŠ¤") || text.includes("DNA")) {
                    reply = "ë°”ì´ëŸ¬ìŠ¤ DNAê°€ ìœ ì „ ë¬¼ì§ˆì„ì„ ì¦ëª…í•œ Hershey-Chase ì‹¤í—˜ì´ ì¤‘ìš”í•©ë‹ˆë‹¤(1í˜ì´ì§€). ë‹¨ë°±ì§ˆì´ ì•„ë‹Œ DNAê°€ ì„¸í¬ë¡œ ë“¤ì–´ê°„ë‹¤ëŠ” ì ì„ ê¼­ ê¸°ì–µí•˜ì„¸ìš”.";
                    sourcePage = "page-1";
                } else {
                    reply = "ê°•ì˜ë¡ê³¼ ì¡±ë³´ ë‚´ì—ì„œ í•´ë‹¹ ë‚´ìš©ì„ ì°¾ê³  ìˆìŠµë‹ˆë‹¤. 'Mitosis'ë‚˜ 'ë°”ì´ëŸ¬ìŠ¤'ì— ëŒ€í•´ ë¬¼ì–´ë´ ì£¼ì‹œê² ì–´ìš”?";
                }

                addMessage('ai', reply, sourcePage);
            }, 800);
        }

        function addMessage(type, text, sourceId = null) {
            const box = document.getElementById('chat-box');
            const msgDiv = document.createElement('div');
            msgDiv.className = `message ${type}`;
            
            let contentHtml = text;
            if (type === 'ai') {
                contentHtml = `<div class="ai-bubble">
                                ${text}
                                <div class="ai-source">
                                    ${sourceId ? `<i class="fas fa-book-open"></i> <span onclick="jumpTo('${sourceId}')" style="cursor:pointer; text-decoration:underline;">ê´€ë ¨ í˜ì´ì§€ ì´ë™</span>` : ''}
                                    <button class="save-snippet-btn" onclick="saveItem('AI ë‹µë³€', '${text.substring(0,15)}...', '${sourceId || 'page-1'}')">ì €ì¥</button>
                                </div>
                               </div>`;
            } else {
                msgDiv.innerText = text;
            }

            if (type === 'ai') msgDiv.innerHTML = contentHtml;
            
            box.appendChild(msgDiv);
            box.scrollTop = box.scrollHeight;
        }

        // --- 5. ì €ì¥ ê¸°ëŠ¥ (Save Logic) ---
        let savedCount = 0;
        function saveItem(type, text, targetId) {
            const list = document.getElementById('saved-list');
            const emptyMsg = list.querySelector('div');
            if (emptyMsg) emptyMsg.style.display = 'none';

            const card = document.createElement('div');
            card.className = `saved-card ${type === 'ì¡±ë³´' ? 'jokbo-type' : ''}`;
            card.onclick = () => jumpTo(targetId);
            card.innerHTML = `
                <div style="font-size:10px; color:#888; margin-bottom:5px;">
                    <span style="background:#eee; padding:2px 5px; border-radius:3px;">${type}</span> 
                    ${targetId.replace('page-', '')}í˜ì´ì§€
                </div>
                <div style="font-weight:bold; font-size:14px;">${text}</div>
            `;
            
            list.prepend(card);
            
            // ì¹´ìš´íŠ¸ ì—…ë°ì´íŠ¸
            savedCount++;
            const badge = document.getElementById('save-count');
            badge.innerText = savedCount;
            badge.style.display = 'inline-block';

            // íƒ­ ì´ë™ íš¨ê³¼ (ì„ íƒì‚¬í•­)
            // setTab('saved'); 
            
            // ì €ì¥ ì™„ë£Œ í”¼ë“œë°± (ê°„ë‹¨í•œ ì• ë‹ˆë©”ì´ì…˜ì´ë‚˜ í† ìŠ¤íŠ¸ ëŒ€ì‹  ë²„íŠ¼ í…ìŠ¤íŠ¸ ë³€ê²½ ë“± ê°€ëŠ¥)
        }
        
        // ì´ˆê¸°í™”: ì²« ë²ˆì§¸ íƒ­ ë²„íŠ¼ í™œì„±í™” ìƒíƒœ ë§ì¶”ê¸°
        document.querySelector('.tab-btn').classList.add('active');
    </script>
</body>
</html>
                setSelectedText('');
                alert("ê°•ì˜ë¡ ì˜†ì— ë©”ëª¨ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!");
            };

            return (
                <div className="flex h-screen bg-gray-100 font-sans text-gray-800 overflow-hidden">
                    
                    {/* ì™¼ìª½: ìŠ¤ë§ˆíŠ¸ ê°•ì˜ë¡ */}
                    <div className="w-3/5 bg-white p-6 overflow-y-auto border-r border-gray-200 shadow-sm">
                        <header className="mb-6 flex items-center justify-between">
                            <h1 className="text-2xl font-bold flex items-center gap-2 text-indigo-700">
                                ğŸ“„ ë§ˆì¼€íŒ… ì›ë¡  3ì£¼ì°¨
                            </h1>
                            <span className="text-sm bg-red-100 text-red-600 px-3 py-1 rounded-full font-medium flex items-center gap-1">
                                ğŸ¯ ì¡±ë³´ ë§¤ì¹­ 2ê±´
                            </span>
                        </header>

                        <div className="space-y-6">
                            {DEMO_SCRIPT.map((line) => (
                                <div key={line.id} className="relative group hover:bg-gray-50 p-2 rounded transition">
                                    <span className="text-xs text-gray-400 absolute -left-0 top-3 font-mono">{line.time}</span>
                                    
                                    <div className="pl-12 pr-4">
                                        <p className={`text-lg leading-relaxed ${line.isJokbo ? 'bg-red-50 decoration-red-200 underline decoration-2 underline-offset-4' : ''}`}>
                                            {line.text}
                                        </p>
                                        
                                        {line.isJokbo && (
                                            <div className="mt-2 text-sm text-red-600 bg-white border border-red-200 p-2 rounded-md shadow-sm inline-block">
                                                ğŸ”¥ <b>ì¡±ë³´ Tip:</b> {line.jokboNote}
                                            </div>
                                        )}
                                    </div>

                                    {savedNotes.filter(note => note.relatedScriptId === line.id).map(note => (
                                        <div key={note.id} className="absolute right-0 top-0 translate-x-full w-48 bg-yellow-100 p-3 rounded-lg shadow-md border-l-4 border-yellow-400 ml-4">
                                            <span className="text-xs font-bold text-yellow-700 block mb-1">ğŸ“Œ AI ì±„íŒ… ì €ì¥ë¨</span>
                                            <p className="text-sm text-gray-700 line-clamp-3">{note.text}</p>
                                        </div>
                                    ))}
                                </div>
                            ))}
                        </div>
                    </div>

                    {/* ì˜¤ë¥¸ìª½: AI íŠœí„° */}
                    <div className="w-2/5 flex flex-col bg-slate-50">
                        <div className="p-4 bg-white border-b border-gray-200 shadow-sm flex justify-between items-center">
                            <h2 className="font-bold text-lg flex items-center gap-2 text-slate-700">
                                ğŸ¤– AI í•™ìŠµ íŠœí„°
                            </h2>
                            {selectedText && (
                                <button 
                                    onClick={saveNote}
                                    className="bg-indigo-600 hover:bg-indigo-700 text-white text-xs px-3 py-1.5 rounded-full flex items-center gap-1 animate-bounce"
                                >
                                    ğŸ’¾ ì„ íƒ ë‚´ìš© ì €ì¥í•˜ê¸°
                                </button>
                            )}
                        </div>

                        <div className="flex-1 overflow-y-auto p-4 space-y-4" onMouseUp={handleTextSelect}>
                            {messages.map((msg, idx) => (
                                <div key={idx} className={`flex ${msg.role === 'user' ? 'justify-end' : 'justify-start'}`}>
                                    <div className={`max-w-[85%] p-3 rounded-2xl shadow-sm text-sm ${
                                        msg.role === 'user' 
                                            ? 'bg-indigo-600 text-white rounded-tr-none' 
                                            : 'bg-white text-gray-800 border border-gray-200 rounded-tl-none'
                                    }`}>
                                        {msg.text}
                                    </div>
                                </div>
                            ))}
                        </div>

                        <div className="p-4 bg-white border-t border-gray-200">
                            <div className="relative">
                                <input
                                    type="text"
                                    value={input}
                                    onChange={(e) => setInput(e.target.value)}
                                    onKeyPress={(e) => e.key === 'Enter' && handleSend()}
                                    placeholder="ê°•ì˜ ë‚´ìš©ì´ë‚˜ ì¡±ë³´ì— ëŒ€í•´ ë¬¼ì–´ë³´ì„¸ìš”..."
                                    className="w-full pl-4 pr-12 py-3 bg-gray-100 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500 transition"
                                />
                                <button onClick={handleSend} className="absolute right-2 top-2 p-1.5 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700">
                                    â¤
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<DemoApp />);
    </script>
</body>
</html>

